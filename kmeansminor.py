from pymongo import MongoClient
import numpy as np
from sklearn.cluster import KMeans
from matplotlib import pyplot
client=MongoClient()
db=client.zipwatch

ata = []
zipcodelist = [10013,10004,10006,10282,10038,10002,10003,10009,10011,10010,10001,10016,10022,10019, 10036, 10021, 10065
              , 10128, 10023, 10024, 10029, 10035, 10027, 10026, 10031, 10030, 10039, 10032,
             10040,10454,10455,10459,10451,10462,10472,10473,10456,10468,10466,10475,10457,10460,10469,10461,10461,
             10463,10467,10458,11224,11229,11235,11214,11210,11204,11219,11203,11226,11209,11220,11236,11230,11225,11212,11233,11208,11207,11239,11231,11213,11217,11215,11216,11221
             ,11237,11201,11205,11238,11211,11206,11222,11691,11418,11416,11432,11451,11385,11426,11691,11418,11416,11432,11451,11385,11426,
             11427, 11411, 11413,  11365,11101,11354,11355,11368,11373,11364,11361,11375,11412,11434,11436,
             11103,11106,10312,10304,10306,10301,10025,11694,11417,11366,11367,10012,10007,10280,10005,10014,10017,10020,10028,10075,10162,10037,10033,10034,10474,10452,10464,
             10465,10453,10470,10471,11223,11234,11218,11228,11232,11692,11693,11695,11697,11690,11415,11421,11419,11424,11423,11435,11405,11431,11433,11439,11499,11379,11381,11428
                ,11429,11422,11005,11001,11002,11004,11414,11425,11104,11377,11378,11109,11356,11357,11358,11359,11360,11351,11352,11386,11390,11380,11362,11363,11430
                ,11369,11370,11372,11371,10069,11374,11102,11105,10044]

for index in zipcodelist:
    cursor=db.minorcrimePred.find({"zipcode":index}).distinct("predict")
    cursor1=db.minorcrimeCurr.find({"zipcode":index}).distinct("current")

    for record in cursor:
        for document in cursor1:

            list=(document,record)
            ata.append(list)
data=np.array(ata)

kmeans=KMeans(n_clusters=5)
kmeans.fit(data)
centroids=kmeans.cluster_centers_
labels=kmeans.labels_

print(centroids)
print(labels)













